import{g as e,p as t,x as a,q as i,v as s,y as l,z as c,s as h,j as o,e as g,w as n,d as r,m as d,F as m,i as u,L as p,o as f,f as k,c as y,k as I,t as _,l as b,A as W,D as w}from"./index-RhgdNjAU.js";import{_ as v}from"./_plugin-vue_export-helper.BCo6x5W8.js";const C=v({data:()=>({currentTheme:e("theme")||"light",imagePath:"",processedImage:"",originalImage:"",imageWidth:0,imageHeight:0,isGrayscale:!1,isBlackWhite:!1,filterType:""}),computed:{getImageFilter(){switch(this.filterType){case"grayscale":return"grayscale(100%)";case"blackwhite":return"grayscale(100%) contrast(150%) brightness(120%)";default:return"none"}},currentMode(){return this.isGrayscale?"ÁÅ∞Â∫¶Ê®°Âºè":this.isBlackWhite?"ÈªëÁôΩÊ®°Âºè":"ÂéüÂõæ"},canRestore(){return this.originalImage&&(this.isGrayscale||this.isBlackWhite)}},methods:{goBack(){t()},resetImage(){this.imagePath="",this.processedImage="",this.originalImage="",this.isGrayscale=!1,this.isBlackWhite=!1,this.filterType="",this.$nextTick((()=>{this.chooseImage()}))},previewImage(){const e=document.createElement("canvas"),t=e.getContext("2d"),i=new Image;i.onload=()=>{if(e.width=this.imageWidth,e.height=this.imageHeight,t.drawImage(i,0,0,this.imageWidth,this.imageHeight),"grayscale"===this.filterType){const e=t.getImageData(0,0,this.imageWidth,this.imageHeight),a=e.data;for(let t=0;t<a.length;t+=4){const e=(a[t]+a[t+1]+a[t+2])/3;a[t]=e,a[t+1]=e,a[t+2]=e}t.putImageData(e,0,0)}else if("blackwhite"===this.filterType){const e=t.getImageData(0,0,this.imageWidth,this.imageHeight),a=e.data;for(let t=0;t<a.length;t+=4){const e=(a[t]+a[t+1]+a[t+2])/3>128?255:0;a[t]=e,a[t+1]=e,a[t+2]=e}t.putImageData(e,0,0)}const s=e.toDataURL("image/png");a({urls:[this.filterType?s:this.imagePath],current:0})},i.src=this.imagePath},chooseImage(){i({count:1,success:e=>{const t=e.tempFilePaths[0];this.originalImage=t,this.imagePath=t,this.processedImage="",this.filterType="",this.isGrayscale=!1,this.isBlackWhite=!1,s({src:t,success:e=>{this.imageWidth=e.width,this.imageHeight=e.height}})}})},convertToGrayscale(){this.imagePath&&(l({title:"Â§ÑÁêÜ‰∏≠..."}),this.filterType="grayscale",this.isGrayscale=!0,this.isBlackWhite=!1,this.processedImage=this.imagePath,c(),h({title:"ÁÅ∞Â∫¶ËΩ¨Êç¢ÂÆåÊàê",icon:"success"}))},convertToBlackWhite(){this.imagePath&&(l({title:"Â§ÑÁêÜ‰∏≠..."}),this.filterType="blackwhite",this.isGrayscale=!1,this.isBlackWhite=!0,this.processedImage=this.imagePath,c(),h({title:"ÈªëÁôΩËΩ¨Êç¢ÂÆåÊàê",icon:"success"}))},restoreOriginal(){this.originalImage&&(this.imagePath=this.originalImage,this.processedImage="",this.isGrayscale=!1,this.isBlackWhite=!1,this.filterType="",this.$nextTick((()=>{h({title:"Â∑≤ÊÅ¢Â§çÂéüÂõæ",icon:"success"})})))},saveImage(){if(!this.imagePath)return;l({title:"Â§ÑÁêÜ‰∏≠..."});const e=new Image;e.crossOrigin="anonymous",e.onload=()=>{const t=document.createElement("canvas"),a=t.getContext("2d");if(t.width=this.imageWidth,t.height=this.imageHeight,a.drawImage(e,0,0,this.imageWidth,this.imageHeight),"grayscale"===this.filterType){const e=a.getImageData(0,0,this.imageWidth,this.imageHeight),t=e.data;for(let a=0;a<t.length;a+=4){const e=(t[a]+t[a+1]+t[a+2])/3;t[a]=e,t[a+1]=e,t[a+2]=e}a.putImageData(e,0,0)}else if("blackwhite"===this.filterType){const e=a.getImageData(0,0,this.imageWidth,this.imageHeight),t=e.data;for(let a=0;a<t.length;a+=4){const e=(t[a]+t[a+1]+t[a+2])/3>128?255:0;t[a]=e,t[a+1]=e,t[a+2]=e}a.putImageData(e,0,0)}try{const e=t.toDataURL("image/png"),a=document.createElement("a");a.href=e,a.download=`processed_image_${Date.now()}.png`,document.body.appendChild(a),a.click(),document.body.removeChild(a),c(),h({title:"‰øùÂ≠òÊàêÂäü",icon:"success"})}catch(i){console.error("‰øùÂ≠òÂ§±Ë¥•:",i),c(),h({title:"‰øùÂ≠òÂ§±Ë¥•",icon:"none"})}},e.onerror=()=>{c(),h({title:"ÂõæÁâáÂä†ËΩΩÂ§±Ë¥•",icon:"none"})},e.src=this.imagePath}}},[["render",function(e,t,a,i,s,l){const c=b,h=u,v=W,C=w,T=p;return f(),o(m,null,[g(h,{class:r(["container",s.currentTheme])},{default:n((()=>[g(h,{class:"header-fixed"},{default:n((()=>[g(h,{class:"back-btn",onClick:l.goBack},{default:n((()=>[g(c,{class:"back-icon"},{default:n((()=>[k("‚Üê")])),_:1})])),_:1},8,["onClick"]),g(c,{class:"title"},{default:n((()=>[k("ÁÅ∞Â∫¶ËΩ¨Êç¢")])),_:1})])),_:1}),g(h,{class:"header-placeholder"}),g(h,{class:"content"},{default:n((()=>[s.imagePath?I("",!0):(f(),y(h,{key:0,class:"upload-box",onClick:l.chooseImage},{default:n((()=>[g(c,{class:"upload-icon"},{default:n((()=>[k("üì§")])),_:1}),g(c,{class:"upload-text"},{default:n((()=>[k("ÁÇπÂáªÈÄâÊã©ÂõæÁâá")])),_:1}),g(c,{class:"upload-tip"},{default:n((()=>[k("ÊîØÊåÅjpg„ÄÅpngÊ†ºÂºè")])),_:1})])),_:1},8,["onClick"])),s.imagePath?(f(),o(m,{key:1},[g(h,{class:"image-info"},{default:n((()=>[g(c,{class:"info-text"},{default:n((()=>[k("ÂõæÁâáÂ∞∫ÂØ∏: "+_(s.imageWidth)+" x "+_(s.imageHeight),1)])),_:1}),g(c,{class:"info-text"},{default:n((()=>[k("ÂΩìÂâçÊ®°Âºè: "+_(l.currentMode),1)])),_:1})])),_:1}),g(h,{class:"preview-container"},{default:n((()=>[g(h,{class:"preview-box"},{default:n((()=>[g(c,{class:"preview-title"},{default:n((()=>[k("Â§ÑÁêÜÊïàÊûú")])),_:1}),g(v,{src:s.imagePath,mode:"aspectFit",class:"preview-image",style:d({filter:l.getImageFilter}),onClick:l.previewImage},null,8,["src","style","onClick"])])),_:1})])),_:1}),g(h,{class:"control-panel"},{default:n((()=>[g(h,{class:"button-group"},{default:n((()=>[g(C,{class:"btn",onClick:l.convertToGrayscale,disabled:s.isGrayscale},{default:n((()=>[k("ËΩ¨Êç¢ÁÅ∞Â∫¶")])),_:1},8,["onClick","disabled"]),g(C,{class:"btn",onClick:l.convertToBlackWhite,disabled:s.isBlackWhite},{default:n((()=>[k("ËΩ¨Êç¢ÈªëÁôΩ")])),_:1},8,["onClick","disabled"])])),_:1}),g(C,{class:"primary-btn",onClick:l.saveImage,disabled:!s.processedImage},{default:n((()=>[k("‰øùÂ≠òÂõæÁâá")])),_:1},8,["onClick","disabled"]),g(C,{class:"reset-btn",onClick:l.resetImage},{default:n((()=>[k("ÈáçÊñ∞ÈÄâÊã©")])),_:1},8,["onClick"]),g(C,{class:"restore-btn",onClick:l.restoreOriginal,disabled:!l.canRestore},{default:n((()=>[k("ÊÅ¢Â§çÂéüÂõæ")])),_:1},8,["onClick","disabled"])])),_:1})],64)):I("",!0)])),_:1})])),_:1},8,["class"]),g(T,{"canvas-id":"imageCanvas",class:"hidden-canvas",style:d({width:s.imageWidth?s.imageWidth+"px":"100px",height:s.imageHeight?s.imageHeight+"px":"100px"})},null,8,["style"])],64)}],["__scopeId","data-v-ee4312c7"]]);export{C as default};
